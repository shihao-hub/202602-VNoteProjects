# 模块四：Skills（技能系统）

> 了解 Agent 的专业能力模块

---

## 第13章：Skills 概念与作用

### 13.1 什么是 Skill

**Skill（技能）** 是为 Agent 定义的特定能力模块，包含完成某类任务所需的指令、工具和知识。

```
简单理解：

如果 Agent 是一个员工，那么：
• LLM = 员工的智商和基本能力
• Tools = 员工可以使用的工具
• Skills = 员工的专业技能证书

同一个 Agent，加载不同的 Skill，就能胜任不同的工作：

┌─────────────┐
│    Agent    │
└──────┬──────┘
       │
  加载不同 Skill
       │
┌──────┴──────────────────────────────────────┐
│                                              │
▼              ▼              ▼               ▼
┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐
│代码审查   │  │文档生成   │  │数据分析   │  │部署发布   │
│  Skill   │  │  Skill   │  │  Skill   │  │  Skill   │
└──────────┘  └──────────┘  └──────────┘  └──────────┘
```

### 13.2 Skill 与 Agent 的关系

```
┌─────────────────────────────────────────────────────────┐
│                    关系图解                             │
├─────────────────────────────────────────────────────────┤
│                                                         │
│                    ┌──────────┐                         │
│                    │  Agent   │                         │
│                    └────┬─────┘                         │
│                         │                               │
│            ┌────────────┼────────────┐                 │
│            │            │            │                 │
│            ▼            ▼            ▼                 │
│       ┌─────────┐  ┌─────────┐  ┌─────────┐           │
│       │  LLM    │  │  Tools  │  │ Skills  │           │
│       │ (大脑)  │  │ (工具)  │  │ (技能)  │           │
│       └─────────┘  └─────────┘  └────┬────┘           │
│                                      │                 │
│                          ┌───────────┴───────────┐     │
│                          ▼           ▼           ▼     │
│                     ┌────────┐  ┌────────┐  ┌────────┐ │
│                     │Skill A│  │Skill B│  │Skill C│ │
│                     └────────┘  └────────┘  └────────┘ │
│                                                         │
└─────────────────────────────────────────────────────────┘

关系说明：
• Agent 是容器，包含 LLM、Tools 和 Skills
• Skills 是可插拔的能力模块
• 一个 Agent 可以加载多个 Skills
• Skills 可以定义专用的 Tools 和指令
```

### 13.3 Skill 解决的问题

```
问题 1：通用 Agent 在专业任务上表现不佳
─────────────────────────────────────────
通用 Agent："写一个 commit message"
→ 可能格式不规范，不符合项目约定

使用 Git Commit Skill 的 Agent：
→ 自动遵循 Conventional Commits 规范
→ 检查暂存区状态
→ 生成符合项目风格的 message

问题 2：重复的指令和配置
─────────────────────────────────────────
每次都要写：
"请用 Markdown 格式，包含代码示例，
 使用中文，注意安全性..."

使用 Skill：
定义一次，到处使用，保持一致

问题 3：知识和最佳实践的封装
─────────────────────────────────────────
不用 Skill：
Agent 可能不知道最佳实践，每次要提醒

用 Skill：
把领域知识和最佳实践封装进去
Agent 自动应用这些知识
```

### 13.4 类比理解

> **Skill 是 Agent 的"专业技能证书"**

```
想象一个通用的助理（Agent）：

没有任何 Skill：
┌─────────────────────────────────────────────┐
│ 助理：我有基本的理解和沟通能力              │
│ 用户：帮我审计一下这份财务报表              │
│ 助理：呃...我可以试试，但可能不够专业...   │
└─────────────────────────────────────────────┘

加载了"财务审计 Skill"：
┌─────────────────────────────────────────────┐
│ 助理 + 财务审计 Skill：                     │
│ • 我知道审计的标准流程                      │
│ • 我了解会计准则                            │
│ • 我知道要检查哪些关键点                    │
│ • 我会使用专业的财务分析工具                │
│                                             │
│ 用户：帮我审计一下这份财务报表              │
│ 助理：好的，让我按照审计流程来...          │
│      首先检查资产负债表的平衡性...          │
└─────────────────────────────────────────────┘

现实中的例子：
• Qoder 中的 "commit" Skill → 专业的 Git 提交
• Qoder 中的 "review-pr" Skill → 专业的代码审查
• Qoder 中的 "create-skill" Skill → 专业的 Skill 开发指导
```

---

## 第14章：Skills 的设计与结构

### 14.1 Skill 的组成元素

```
一个完整的 Skill 通常包含：

┌─────────────────────────────────────────────────────────┐
│                    Skill 结构                           │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  1. 元信息（Metadata）                                  │
│  ─────────────────────                                  │
│  • 名称（name）                                         │
│  • 描述（description）                                  │
│  • 版本（version）                                      │
│  • 作者（author）                                       │
│                                                         │
│  2. 触发条件（Triggers）                                │
│  ─────────────────────                                  │
│  • 何时激活这个 Skill                                   │
│  • 关键词、意图、上下文条件                             │
│                                                         │
│  3. 指令（Instructions）                                │
│  ─────────────────────                                  │
│  • 详细的行为指南                                       │
│  • 步骤流程                                             │
│  • 约束和规则                                           │
│                                                         │
│  4. 工具（Tools）                                       │
│  ─────────────────────                                  │
│  • Skill 专用的工具定义                                 │
│  • 或指定使用哪些现有工具                               │
│                                                         │
│  5. 示例（Examples）                                    │
│  ─────────────────────                                  │
│  • 输入输出示例                                         │
│  • 最佳实践示例                                         │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

### 14.2 Skill 描述与触发条件

```
描述（Description）的作用：
─────────────────────────
• 帮助 Agent 理解何时使用这个 Skill
• 帮助用户了解 Skill 的能力
• 用于 Skill 的自动选择和推荐

好的描述示例：
┌─────────────────────────────────────────────┐
│ Name: code-review                           │
│                                             │
│ Description:                                │
│ 专业的代码审查技能。用于审查代码变更，      │
│ 检查代码质量、安全漏洞、性能问题和          │
│ 最佳实践遵循情况。适用于 PR 审查、          │
│ 代码提交前检查等场景。                      │
└─────────────────────────────────────────────┘

触发条件示例：
┌─────────────────────────────────────────────┐
│ 显式触发：                                  │
│ • 用户输入 "/review" 命令                   │
│ • 用户说"审查这段代码"                      │
│                                             │
│ 隐式触发（基于意图识别）：                  │
│ • 用户提交 PR 时                            │
│ • 用户询问代码是否有问题                    │
│ • 检测到代码修改后的审查请求                │
└─────────────────────────────────────────────┘
```

### 14.3 Skill 的指令（Instructions）

```
指令是 Skill 的核心，定义了 Agent 应该如何执行任务

指令结构示例：

┌─────────────────────────────────────────────────────────┐
│ ## Instructions                                         │
│                                                         │
│ ### 角色定义                                            │
│ 你是一个专业的代码审查员，具有丰富的软件开发经验。     │
│                                                         │
│ ### 审查流程                                            │
│ 1. 首先了解变更的背景和目的                             │
│ 2. 检查代码结构和组织                                   │
│ 3. 审查具体实现                                         │
│ 4. 检查测试覆盖                                         │
│ 5. 总结发现并给出建议                                   │
│                                                         │
│ ### 审查要点                                            │
│ - 代码可读性和可维护性                                  │
│ - 安全漏洞（SQL注入、XSS等）                           │
│ - 性能问题                                              │
│ - 错误处理                                              │
│ - 边界情况                                              │
│                                                         │
│ ### 输出格式                                            │
│ 使用以下格式输出审查结果：                              │
│ - 🔴 严重问题：必须修复                                │
│ - 🟡 建议改进：推荐修复                                │
│ - 🟢 小建议：可选优化                                  │
│                                                         │
│ ### 注意事项                                            │
│ - 保持建设性和尊重的语气                                │
│ - 解释问题原因，不只是指出问题                          │
│ - 提供具体的修复建议                                    │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

### 14.4 Skill 的输入输出定义

```
明确的输入输出定义让 Skill 更可靠

输入定义示例：
┌─────────────────────────────────────────────────────────┐
│ ### 输入                                                │
│                                                         │
│ 必需参数：                                              │
│ - code: string - 要审查的代码内容                       │
│ - language: string - 编程语言                           │
│                                                         │
│ 可选参数：                                              │
│ - context: string - 代码的背景说明                      │
│ - focus: string[] - 重点关注的方面                      │
│   可选值: ["security", "performance", "readability"]    │
│ - severity_threshold: string - 报告的最低严重级别       │
│   可选值: ["critical", "warning", "info"]               │
│                                                         │
└─────────────────────────────────────────────────────────┘

输出定义示例：
┌─────────────────────────────────────────────────────────┐
│ ### 输出                                                │
│                                                         │
│ 结构化的审查报告，包含：                                │
│                                                         │
│ {                                                       │
│   "summary": "总体评价",                                │
│   "issues": [                                           │
│     {                                                   │
│       "severity": "critical|warning|info",              │
│       "category": "security|performance|style|logic",   │
│       "line": 42,                                       │
│       "description": "问题描述",                        │
│       "suggestion": "修复建议"                          │
│     }                                                   │
│   ],                                                    │
│   "positive_aspects": ["做得好的地方"],                 │
│   "overall_score": "A|B|C|D|F"                         │
│ }                                                       │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

---

## 第15章：Skills 与 Agent 的协作

### 15.1 Agent 如何发现和选择 Skill

```
Skill 发现和选择流程：

┌─────────────────────────────────────────────────────────┐
│                                                         │
│   用户输入                                              │
│      │                                                  │
│      ▼                                                  │
│  ┌───────────────────────────────────────┐             │
│  │           意图识别                     │             │
│  │   分析用户想要完成什么任务             │             │
│  └───────────────────────┬───────────────┘             │
│                          │                              │
│                          ▼                              │
│  ┌───────────────────────────────────────┐             │
│  │           Skill 匹配                   │             │
│  │   查找与任务匹配的 Skill               │             │
│  │   • 关键词匹配                         │             │
│  │   • 描述相似度                         │             │
│  │   • 上下文适配                         │             │
│  └───────────────────────┬───────────────┘             │
│                          │                              │
│              ┌───────────┼───────────┐                 │
│              ▼           ▼           ▼                 │
│         匹配到       匹配到多个    无匹配              │
│         单个 Skill    Skill                            │
│              │           │           │                 │
│              ▼           ▼           ▼                 │
│         直接加载    选择最佳     使用通用              │
│                     或询问用户   能力处理              │
│                                                         │
└─────────────────────────────────────────────────────────┘

示例：

用户："帮我生成一个 commit message"

Agent 思考：
1. 意图：生成 Git commit message
2. 搜索 Skills：
   - commit Skill ✅ 匹配度高
   - code-review Skill ❌ 不匹配
   - deploy Skill ❌ 不匹配
3. 选择：加载 commit Skill
4. 执行：按照 commit Skill 的指令工作
```

### 15.2 Skill 的调用流程

```
完整的 Skill 调用流程：

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
步骤 1：触发
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
用户："/commit"
     或
用户："帮我提交代码"

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
步骤 2：Skill 加载
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Agent：
• 识别需要 commit Skill
• 加载 Skill 的 Instructions
• 准备 Skill 需要的 Tools

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
步骤 3：执行 Skill 指令
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Agent（遵循 Skill 指令）：
1. 执行 git status 查看变更
2. 执行 git diff 查看具体修改
3. 分析变更内容
4. 根据规范生成 commit message
5. 执行 git commit

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
步骤 4：返回结果
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Agent：
"已提交代码，commit message：
 feat(auth): 添加用户登录功能"
```

### 15.3 Skill 链式调用

```
复杂任务可能需要多个 Skill 协作：

用户任务："帮我完成这个功能，测试通过后提交"

调用链：
┌─────────────────────────────────────────────────────────┐
│                                                         │
│  用户任务                                               │
│      │                                                  │
│      ▼                                                  │
│  ┌──────────────────┐                                  │
│  │   任务分解        │                                  │
│  └────────┬─────────┘                                  │
│           │                                             │
│  ┌────────┴────────────────────────┐                   │
│  │                                 │                   │
│  ▼                                 ▼                   │
│ 子任务 1                        子任务 2               │
│ "实现功能"                      "测试并提交"           │
│  │                                 │                   │
│  │                      ┌──────────┴──────────┐       │
│  │                      │                     │       │
│  ▼                      ▼                     ▼       │
│ ┌────────┐          ┌────────┐          ┌────────┐   │
│ │ Coding │          │ Testing│          │ Commit │   │
│ │ Skill  │    ──▶   │ Skill  │    ──▶   │ Skill  │   │
│ └────────┘          └────────┘          └────────┘   │
│                                                         │
│ 流程：                                                  │
│ 1. Coding Skill 实现功能                               │
│ 2. Testing Skill 运行测试，验证通过                    │
│ 3. Commit Skill 生成 message 并提交                    │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

### 15.4 自定义 Skill 开发入门

```
开发一个简单 Skill 的基本步骤：

步骤 1：确定 Skill 的目标
──────────────────────────
问自己：
• 这个 Skill 要解决什么问题？
• 什么时候应该使用它？
• 它需要什么输入，产生什么输出？

步骤 2：编写 Skill 定义文件（SKILL.md）
──────────────────────────────────────────

示例：创建一个"代码注释生成"Skill

```markdown
# Comment Generator Skill

## Description
为代码自动生成清晰、专业的注释。
支持多种编程语言，遵循各语言的注释规范。

## When to use
- 用户请求为代码添加注释
- 用户输入 "/comment"
- 代码缺少必要的文档

## Instructions

### 你的角色
你是一个专业的技术文档编写者，擅长编写清晰、
简洁、有价值的代码注释。

### 注释原则
1. 解释"为什么"，而不是"是什么"
2. 保持简洁，避免冗余
3. 遵循语言特定的注释规范
4. 关注复杂逻辑和非显而易见的部分

### 执行步骤
1. 分析代码的语言和结构
2. 识别需要注释的部分
3. 为函数/方法添加文档注释
4. 为复杂逻辑添加行内注释
5. 返回添加注释后的代码

### 输出格式
返回完整的、添加了注释的代码，
使用代码块格式。
```

步骤 3：测试和迭代
──────────────────────────
• 用各种输入测试 Skill
• 根据结果调整指令
• 完善边界情况处理
```

---

## 本章小结

```
核心要点回顾：

1. Skill 是什么
   ├── Agent 的专业能力模块
   ├── 包含完成特定任务的指令、工具、知识
   └── 让通用 Agent 能胜任专业任务

2. Skill 的组成
   ├── 元信息：名称、描述、版本
   ├── 触发条件：何时激活
   ├── 指令：如何执行
   ├── 工具：使用什么工具
   └── 示例：输入输出示例

3. Skill 与 Agent 的协作
   ├── 发现：基于意图和关键词匹配
   ├── 选择：找最合适的 Skill
   ├── 加载：读取指令和工具
   ├── 执行：按指令完成任务
   └── 链式调用：多 Skill 协作

4. 开发 Skill
   ├── 确定目标和使用场景
   ├── 编写清晰的指令
   └── 测试和迭代优化
```

---

**下一章 → [第16章：MCP 概述与设计理念](./05-mcp.md)**
