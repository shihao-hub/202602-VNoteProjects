# RIPER-5 工作流模式总结

## 概述

RIPER 是一种用于提升 AI（特别是 Claude 等大模型）在编程或复杂任务中可控性与协作效率的工作流方法。该方法最初由 Cursor 社区提出，并广泛应用于 AI 辅助开发场景。

**核心理念：** 将 AI 从"自主代理"变为"受控协作者"，特别适合复杂、高风险或需多人协作的工程任务。

---

## 五阶段详解

RIPER 代表以下五个阶段（英文首字母缩写）：

### 1️⃣ R – Research（研究）

**目的：** 理解现状、收集信息

**允许行为：**
- 阅读代码文件
- 提出澄清问题
- 分析现有架构或逻辑

**禁止行为：**
- ❌ 提出解决方案
- ❌ 编写代码
- ❌ 做任何"应该怎么做"的建议

**输出示例：**
```
[模式：研究] 我发现项目中有 TranscodeService 和 FileProxy 两个核心类，
它们之间通过 Feign 接口通信。请问您希望重点优化哪一部分？
```

---

### 2️⃣ I – Innovation（创新/思考）

**目的：** 头脑风暴可能的方案

**允许行为：**
- 列出多种实现思路
- 分析各方案优缺点
- 征求用户偏好

**禁止行为：**
- ❌ 制定具体实施步骤
- ❌ 写代码或伪代码
- ❌ 假设用户已选择某方案

**输出示例：**
```
[模式：创新] 可选方案包括：
A) 异步队列解耦
B) 缓存中间状态
C) 合并重复请求
您倾向哪种方向？
```

---

### 3️⃣ P – Plan（计划）

**目的：** 制定可执行的详细技术方案

**要求：**
- 明确文件路径、函数名、修改点
- 输出为编号的原子操作清单

**禁止行为：**
- ❌ 直接写实现代码
- ❌ 使用"示例代码"代替计划

**输出格式：**
```
[模式：规划]
实施检查清单：
1. 在 /service/TranscodeService.java 中新增方法 cacheTaskStatus()
2. 修改 FileProxy 调用逻辑，增加重试机制
3. ...
```

---

### 4️⃣ E – Execution（执行）

**目的：** 严格按计划实施

**原则：**
- 只做计划中写明的事
- 若遇意外（如编译错误、逻辑冲突），立即退回"规划"模式

**禁止行为：**
- ❌ 自作主张"优化"代码
- ❌ 添加计划外的功能或注释

**输出示例：**
```
[模式：执行] 正在修改 TranscodeService.java，添加第1项中的 cacheTaskStatus 方法...
```

---

### 5️⃣ R – Review（审查）

**目的：** 验证执行结果是否与计划完全一致

**操作：**
- 逐项核对实施内容 vs 计划清单
- 标记任何偏差（即使微小）

**输出结论：**
- ✅ 实施与计划完全匹配
- ❌ 实施偏离计划：[具体描述]

**示例：**
```
[模式：审查] ⚠️ 检测到偏离：计划要求添加重试3次，但代码中写了5次。
```

---

## 核心原则

### 用户控制权
- **每次模式切换必须由用户显式指令触发**（如"进入执行模式"）
- AI 不得自行跳转阶段

### 可追溯性
- 每个阶段都有明确的输入输出格式
- 所有问题、方案、计划、执行都有记录

### 可中断性
- 用户可以在任何阶段停止或调整方向
- 执行阶段遇到问题立即退回规划阶段

### 可回滚性
- 严格的审查阶段确保执行与计划一致
- 任何偏差都会被标记和报告

---

## 扩展模式

### FAST 模式
**用途：** 处理简单任务（如单文件小修），避免流程过重

**适用场景：**
- 单行修改
- 简单bug修复
- 注释添加
- 变量重命名

---

## 工作流程图

```
┌─────────────────────────────────────────────────────────┐
│                    RIPER 工作流                          │
├─────────────────────────────────────────────────────────┤
│                                                          │
│   Research → Innovation → Plan → Execution → Review     │
│      ↑                                        ↓         │
│      └──────── 返回（如发现问题）──────────────────┘     │
│                                                          │
└─────────────────────────────────────────────────────────┘
```

---

## 优势总结

| 特性 | 传统AI协作 | RIPER模式 |
|------|-----------|-----------|
| 可控性 | 低，AI自主性强 | 高，用户全程掌控 |
| 可追溯性 | 差，过程混乱 | 好，每步清晰记录 |
| 团队协作 | 难，意图不明确 | 易，计划可共享 |
| 错误风险 | 高，AI自作主张 | 低，严格按计划执行 |
| 适合场景 | 简单任务 | 复杂、高风险任务 |

---

## 适用场景

✅ **推荐使用 RIPER：**
- 复杂系统重构
- 多文件联动修改
- 关键业务逻辑变更
- 需要团队协作的任务
- 对安全性要求高的操作

⚡ **可以使用 FAST 模式：**
- 单文件简单修改
- 注释或文档更新
- 变量命名调整
- 明确的小bug修复

---

**总结：** RIPER = 研究 → 创新 → 计划 → 执行 → 审查

是一套"让 AI 听话、可追溯、可中断、可回滚"的结构化人机协作协议。

---

*文档生成时间：2026年1月22日*
*来源：通义千问 RIPER 主题分享*
